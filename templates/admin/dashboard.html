{% extends "base.html" %}

{% block content %}
    <div class="dashboard-controls">
        <div id="search-container">
            <div class="search-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 100 13.5 6.75 6.75 0 000-13.5zM2.25 10.5a8.25 8.25 0 1114.59 5.28l4.69 4.69a.75.75 0 11-1.06 1.06l-4.69-4.69A8.25 8.25 0 012.25 10.5z" clip-rule="evenodd" /></svg></div>
            <input type="text" id="admin-search-box" placeholder="{{ _('Kütüphanede kayıt ara...') }}">
        </div>
        <!-- Toplu Ekleme Butonu -->
        <button id="bulk-import-btn" class="btn btn-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M10.5 3.75a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5a.75.75 0 01.75-.75zM12 12.75a.75.75 0 00-1.5 0v5.25a.75.75 0 001.5 0v-5.25zM5.25 12a.75.75 0 01.75-.75h4.5a.75.75 0 010 1.5h-4.5a.75.75 0 01-.75-.75z" clip-rule="evenodd" /></svg>
            <span>{{ _('Toplu Ekle') }}</span>
        </button>
        <button id="add-new-record-btn" class="btn btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2h6z"></path></svg>
            <span>{{ _('Yeni Kayıt Ekle') }}</span>
        </button>
    </div>
    <div id="admin-records-list"></div>

    <!-- Ekleme/Düzenleme Modalı -->
    <div id="entry-modal" class="modal">
        <div class="modal-content">
            <span id="close-entry-modal-btn" class="close-btn">&times;</span>
            <h2 id="entry-modal-title">{{ _('Yeni Kütüphane Kaydı') }}</h2>
            <form id="entry-form" enctype="multipart/form-data">
                <input type="hidden" id="record-id-input" name="id">
                <div class="admin-form-grid">
                    <div class="form-group"><label for="original_title">{{ _('Orijinal Başlık:') }}</label><input type="text" id="original_title" name="original_title" required></div>
                    <div class="form-group"><label for="english_title">{{ _('İngilizce Başlık:') }}</label><input type="text" id="english_title" name="english_title"></div>
                </div>
                <div class="form-group"><label for="synopsis">{{ _('Konu:') }}</label><textarea id="synopsis" name="synopsis" rows="5"></textarea></div>
                <div class="form-group"><label for="record_type">{{ _('Tür:') }}</label><select id="record_type" name="record_type"><option value="Manhwa">Manhwa</option><option value="Anime">Anime</option><option value="Manga">Manga</option><option value="Webtoon">Webtoon</option></select></div>
                <div class="form-group"><label for="image_url">{{ _('veya Resim URL:') }}</label><input type="url" id="image_url" name="image_url" placeholder="{{ _('URL yapıştırın') }}"></div>
                <div class="form-group"><label for="image_file">{{ _('Resim Dosyası Seç:') }}</label><input type="file" id="image_file" name="image_file" accept="image/*"></div>
                <div class="modal-actions">
                    <button type="button" id="delete-record-btn" class="btn btn-danger" style="margin-right: auto;">{{ _('Kaydı Sil') }}</button>
                    <button type="submit" class="btn btn-primary">{{ _('Değişiklikleri Kaydet') }}</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Toplu Ekleme (Bulk Import) Modalı -->
    <div id="bulk-import-modal" class="modal">
        <div class="modal-content">
            <span id="close-bulk-modal-btn" class="close-btn">&times;</span>
            <h2>{{ _('Toplu Kayıt Ekle') }}</h2>
            <p style="color: var(--text-secondary);">{{ _('Lütfen .json formatında bir dosya seçin.') }}</p>
            <form id="bulk-import-form" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="import_file">{{ _('İçe Aktarılacak Dosya:') }}</label>
                    <!-- Sadece .json kabul edecek şekilde güncellendi -->
                    <input type="file" id="import_file" name="import_file" accept=".json" required>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">{{ _('İçe Aktar') }}</button>
                </div>
            </form>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="{{ url_for('static', filename='js/admin.js') }}"></script>
{% endblock %}